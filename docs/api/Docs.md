## Entity

A class used to attach functionality to a single DOM Element.

### Usage
```js
const MyEntity = new Entity([EntityConfigObject])
```

## Definitions

### `EntityConfigObject`
A configuration object for an `Entity`.

```js
{
  name: String,
  selector: CSSSelectorString, // optional
  manages: Array<Entity>, // optional
  initialState: String, // optional
  data: DataConfigObject, // optional
  references: ReferenceConfigObject, //optional
  states: StateMachineConfigObject|Array<StateMachineConfigObject>, // optional
  on: EventBusConfigObject // optional
}
```

#### Properties

`@property name {String}`

Event namespace. All events fired by this Entity will be prefixed with `${name}.`

Additional reading:
- GUIDE: [Communicating amongst Entities with Events]()

`@property selector {CSSSelectorString}`

Selector string of a pre-existing DOM Element to which to attach this Entity. This selector string will automatically be prefixed with the selector string of the parent Entity, if one exists.

If this Entity will be attached to a DOM Element generated at run-time, leave this property off.

`@property manages {Array<Entity>}`

 An array of Entities which should be managed by this Entity.
 
 Any child Entities generated by this Entity at run-time will automatically be managed by it, so this propert should only be used in conjunction with the `selector` property to attach Entity functionality to DOM Elements that already exist at run-time, or to manage Entities which are not generated by this Entity (this should rarely be needed).

`@property initialState {String}`

Name of the state which should be activated upon initialization of this Entity.

Additional reading:
- GUIDE: [Entity State Management]()

`@property data {DataConfigObject}`

Specification of any data fields, models or stores which will be managed by this Entity. This data is only accessble within the scope of this Entity.

Additional reading:
- [DataConfigObject]()
- GUIDE: [Data Management in Jet]()

`@property references {ReferenceConfigObject}`

Specification of any DOM Elements rendered or managed by this Entity which will need to be directly accessed.

Additional reading:
- [ReferenceConfigObject]()
- GUIDE: [Working with DOM Element References]()

`@property states {StateMachineConfigObject|Array<StateMachineConfigObject>}`

Specification of this Entity's states. 

If a `StateMachineConfigObject` is passed in, this Entity will initialize a single state machine, meaning it can be in a single state at any given time.

If an array of `StateMachineConfigObject` is passed in, multiple state machines will be initialized, allowing this Entity to be in more than one state at any given time.

Additional information:
- [StateMachineConfigObject]()
- GUIDE: [Entity State Management]()

`@property on {EventBusConfigObject}`

Specification of any event listeners which this Entity will respond to.

Additional reading:
- [EventBusConfigObject]()
- GUIDE: [Communicating between Entities with Events]()

#### Example

```js
import { Entity, DataStore, html } from 'jet'
import Toolbar from './Toolbar.js'

const UserMenu = new Entity({
  name: 'menu',
  selector: 'header > menu.user',
  manages: [Toolbar],
  initialState: 'closed',

  data: {
    label: String,

    options: new DataStore({
      fields: {
        label: String,
        view: String
      }
    })
  },

  references: {
    closeButton: '> button.close'
  },

  states: {
    closed () {
      this.root.classList.add('hidden')
      this.refs.closeButton.removeAttribute('active')
    },

    open () {
      this.root.classList.remove('hidden')
      this.refs.closeButton.setAttribute('active')
    }
  },

  on: {
    initialize () {
      this.render(html`
        ${this.data.options.map(({ label, view }) => html`
          ${this.bind({
            on: {
              click: evt => this.emit('view.goto', view)
            }
          }, html`<li>${label}</li>`)}
        `)}
      `)
    },

    open () {
      this.states.set('open')
    },

    close () {
      this.states.set('closed')
    }
  }
})
```


### Methods

### `render()`

Render new DOM to the view or reconcile existing DOM.

#### API
```js
this.render([TTL])
```

Jet uses Tagged Template Literals (TTLs) to render DOM. TTLs are a native JavaScript feature. See [MDN's Tagged Templates article](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#tagged_templates) for information on how they work.

Jet includes the following TTLs:

##### html

Renders html strings and generates virtual DOM for reconciliation.

Usage:
```js
this.render(html`[HTMLString]`)
```

See [HTMLString]()

##### svg

Renders namespaced svg strings and generates virtual DOM for reconciliation.

Usage:
```js
this.render(svg`[SVGString]`)
```

See [SVGString]()

##### md

Generates HTML from Markdown syntax.

Usage:
```js
this.render(md`[MarkdownString]`)
```

See [MarkdownString]()

---
## Renderer

### HTMLString

Strings of HTML used by Jet to generate or reconcile DOM Elements. These are just JavaScript Template Strings with some some special interpolation types:

#### `TextInterpolation`
Interpolation of basic text.

```js
const myText = 'Hello!'

this.render(html`${myText}`)
```

##### Output
```html
Hello!
```

#### `TTLInterpolation`

Direct interpolation of a Tagged Template Literal. This is useful if you want to configure a TTL separately from your render function.

```js
const myTemplateString = html`<div>Here is a div</div>`

this.render(html`${myTemplateString}`)
```

##### Output
```html
<div>Here is a div</div>
```


It is also possible to configure the TTL directly in the render function:

```js
this.render(html`
  ${html`<div>Here is a div</div>`}
`)
```

However, the reasons to do this in real-world code are extremely limited.

#### `BooleanInterpolation`

Interpolation of a boolean value. This is useful for interpolating different TTLs depending on the value of a boolean:

```js
this.render(html`
  <div class="toolbar">
    ${showButton && html`<button>Click Me</button>`}
  </div>
`)
```

If `showButton` is false, the interpolation will return `false` which will result in a placeholder being added into the HTML output:

```html
<div class="toolbar">
  <!-- i0 -->
</div>  
```

If `showButton` is true, a `TTLInterpolation` will be returned instead, resulting in the following output:

```html
<div class="toolbar">
  <button>Click Me</button>
</div>  
```

### `PlaceholderInterpolation`



### `ArrayInterpolation`



### `BatchInterpolation`



### `DataBindingInterpolation`



### `PartialInterpolation`

